{
  "log": {
    "level": "info",
    "timestamp": true
  },

  "experimental": {
    "cache_file": {
      "enabled": true,
      "store_fakeip": false
    },
    "clash_api": {
      "external_controller": "127.0.0.1:9090",
      "external_ui": "ui",
      "secret": "",
      "external_ui_download_url": "https://gh-proxy.com/https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip",
      "external_ui_download_detour": "direct",
      "default_mode": "rule"
    }
  },

  "dns": {
    "strategy": "ipv4_only",
    "final": "localDns",
    "servers": [
      { "tag": "proxyDns", "address": "tls://8.8.8.8", "detour": "Proxy" },
      { "tag": "localDns", "address": "https://223.5.5.5/dns-query", "detour": "direct" }
    ],
    "rules": [
      { "outbound": "any", "server": "localDns" },
      { "rule_set": "geosite-cn", "server": "localDns" },
      { "clash_mode": "direct", "server": "localDns" },
      { "clash_mode": "global", "server": "proxyDns" },
      { "rule_set": "geosite-geolocation-!cn", "server": "proxyDns" }
    ]
  },

  "inbounds": [
    {
      "tag": "tun-in",
      "type": "tun",
      "address": ["172.19.0.0/30"],
      "mtu": 9000,
      "auto_route": true,
      "strict_route": true,
      "stack": "system",
      "platform": {
        "http_proxy": {
          "enabled": true,
          "server": "127.0.0.1",
          "server_port": 2080
        }
      }
    },
    {
      "tag": "mixed-in",
      "type": "mixed",
      "listen": "127.0.0.1",
      "listen_port": 2080
    }
  ],

  "outbounds": [
    { "tag": "Proxy", "type": "selector", "outbounds": ["auto","direct","{all}"] },
    { "tag": "OpenAI", "type": "selector", "outbounds": ["TaiWan","Singapore","Japan","America","Others"], "default": "America" },
    { "tag": "Google", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Telegram", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Twitter", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Facebook", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "BiliBili", "type": "selector", "outbounds": ["direct","HongKong","TaiWan"] },
    { "tag": "Bahamut", "type": "selector", "outbounds": ["TaiWan","Proxy"] },
    { "tag": "Spotify", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"], "default": "America" },
    { "tag": "TikTok", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America"], "default": "Japan" },
    { "tag": "Netflix", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Disney+", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Apple", "type": "selector", "outbounds": ["direct","HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Microsoft", "type": "selector", "outbounds": ["direct","HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Games", "type": "selector", "outbounds": ["direct","HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Streaming", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others"] },
    { "tag": "Global", "type": "selector", "outbounds": ["HongKong","TaiWan","Singapore","Japan","America","Others","direct"] },
    { "tag": "China", "type": "selector", "outbounds": ["direct","Proxy"] },
    { "tag": "HongKong", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "include", "keywords": ["ğŸ‡­ğŸ‡°|HK|hk|é¦™æ¸¯|æ¸¯|HongKong"] }] },
    { "tag": "TaiWan", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "include", "keywords": ["ğŸ‡¹ğŸ‡¼|TW|tw|å°æ¹¾|è‡ºç£|å°|Taiwan"] }] },
    { "tag": "Singapore", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "include", "keywords": ["ğŸ‡¸ğŸ‡¬|SG|sg|æ–°åŠ å¡|ç‹®|Singapore"] }] },
    { "tag": "Japan", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "include", "keywords": ["ğŸ‡¯ğŸ‡µ|JP|jp|æ—¥æœ¬|æ—¥|Japan"] }] },
    { "tag": "America", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "include", "keywords": ["ğŸ‡ºğŸ‡¸|US|us|ç¾å›½|ç¾|United States"] }] },
    { "tag": "Others", "type": "selector", "outbounds": ["{all}"], "filter": [{ "action": "exclude", "keywords": ["ğŸ‡­ğŸ‡°|HK|hk|é¦™æ¸¯|é¦™|ğŸ‡¹ğŸ‡¼|TW|tw|å°æ¹¾|å°|ğŸ‡¸ğŸ‡¬|SG|sg|æ–°åŠ å¡|ç‹®|ğŸ‡¯ğŸ‡µ|JP|jp|æ—¥æœ¬|æ—¥|ğŸ‡ºğŸ‡¸|US|us|ç¾å›½|ç¾"] }] },
    { "tag": "auto", "type": "urltest", "outbounds": ["{all}"], "filter": [{ "action": "exclude", "keywords": ["ç½‘ç«™","åœ°å€","å‰©ä½™","è¿‡æœŸ","æ—¶é—´","æœ‰æ•ˆ"] }], "url": "http://www.gstatic.com/generate_204", "interval": "10m", "tolerance": 50 },
    { "tag": "direct", "type": "direct" }
  ],

  "route": {
    "auto_detect_interface": true,
    "final": "Proxy",
    "rules": [
      { "inbound": ["tun-in","mixed-in"], "action": "sniff" },
      { "type": "logical", "mode": "or", "rules": [{ "port": 53 }, { "protocol": "dns" }], "action": "hijack-dns" },
      { "rule_set": "geosite-category-ads-all", "clash_mode": "rule", "action": "reject" },
      { "rule_set": "geosite-category-ads-all", "clash_mode": "global", "outbound": "Proxy" },
      { "clash_mode": "direct", "outbound": "direct" },
      { "clash_mode": "global", "outbound": "Proxy" },
      { "domain": ["clash.razord.top","yacd.metacubex.one","yacd.haishan.me","d.metacubex.one"], "outbound": "direct" },
      { "ip_is_private": true, "outbound": "direct" },
      { "rule_set": "geosite-openai", "outbound": "OpenAI" },
      { "rule_set": ["geosite-youtube","geoip-google","geosite-google","geosite-github"], "outbound": "Google" },
      { "rule_set": ["geoip-telegram","geosite-telegram"], "outbound": "Telegram" },
      { "rule_set": ["geoip-twitter","geosite-twitter"], "outbound": "Twitter" },
      { "rule_set": ["geoip-facebook","geosite-facebook"], "outbound": "Facebook" },
      { "rule_set": "geosite-bilibili", "outbound": "BiliBili" },
      { "rule_set": "geosite-bahamut", "outbound": "Bahamut" },
      { "rule_set": "geosite-spotify", "outbound": "Spotify" },
      { "rule_set": "geosite-tiktok", "outbound": "TikTok" },
      { "rule_set": ["geoip-netflix","geosite-netflix"], "outbound": "Netflix" },
      { "rule_set": "geosite-disney", "outbound": "Disney+" },
      { "rule_set": ["geoip-apple","geosite-apple","geosite-amazon"], ... ]}
]}]}
